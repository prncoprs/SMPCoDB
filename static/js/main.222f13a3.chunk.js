(this.webpackJsonpwebapp=this.webpackJsonpwebapp||[]).push([[2],{471:function(e,t,n){},739:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),o=n(105),c=n.n(o),s=(n(471),n(472),n(12)),i=n.n(s),l=n(278),u=n(0),d=n(1),b=n(5),j=n(6),m=n(7),g=n(250),p=[{keyword:"select",desc:""},{keyword:"from",desc:""},{keyword:"where",desc:""},{keyword:"sum",desc:"Aggregation function"},{keyword:"max",desc:"Aggregation function"},{keyword:"avg",desc:"Aggregation function"},{keyword:"count",desc:"Aggregation function"},{keyword:"group by",desc:""},{keyword:"desc",desc:""},{keyword:"limit",desc:""},{keyword:"having",desc:""},{keyword:"exists",desc:""}],h=function(){function e(){Object(u.a)(this,e)}return Object(d.a)(e,null,[{key:"getURL",value:function(e){return new URL(e,"https://cwvf54ckb6.execute-api.ap-east-1.amazonaws.com/dev/").href}},{key:"generateHover",value:function(e,t,n,a){if(!a)return{range:e,contents:[]};var r,o=JSON.parse(a),c=Object(m.a)(p);try{for(c.s();!(r=c.n()).done;){var s=r.value;if(n.toLowerCase().includes(s.keyword.toLowerCase()))return{range:e,contents:[{value:"SQL Built In"},{value:s.desc}]}}}catch(g){c.e(g)}finally{c.f()}var i,l=Object(m.a)(o);try{for(l.s();!(i=l.n()).done;){var u=i.value;if(n.toLowerCase().includes(u.table_name.toLowerCase()))return{range:e,contents:[{value:"Table Name"}]};var d,b=Object(m.a)(u.columns);try{for(b.s();!(d=b.n()).done;){var j=d.value;if(n.toLocaleLowerCase().includes(j.name.toLowerCase()))return{range:e,contents:[{value:u.table_name},{value:"**Type: ".concat(j.column_type,"**")}]}}}catch(g){b.e(g)}finally{b.f()}}}catch(g){l.e(g)}finally{l.f()}}},{key:"generateSuggestions",value:function(e,t){if(t){var n,a=JSON.parse(t),r=[],o=Object(m.a)(a);try{for(o.s();!(n=o.n()).done;){var c=n.value;r.push({label:c.table_name,kind:g.a.CompletionItemKind.Constant,documentation:"",insertText:c.table_name.toUpperCase(),insertTextRules:g.a.CompletionItemInsertTextRule.InsertAsSnippet,range:e});var s,i=Object(m.a)(c.columns);try{for(i.s();!(s=i.n()).done;){var l=s.value;r.push({label:l.name,kind:g.a.CompletionItemKind.Constant,documentation:"".concat(l.column_type),insertText:l.name,insertTextRules:g.a.CompletionItemInsertTextRule.InsertAsSnippet,range:e})}}catch(j){i.e(j)}finally{i.f()}}}catch(j){o.e(j)}finally{o.f()}var u,d=Object(m.a)(p);try{for(d.s();!(u=d.n()).done;){var b=u.value;r.push({label:b.keyword,kind:g.a.CompletionItemKind.Keyword,document:b.desc,insertText:b.keyword.toUpperCase(),insertTextRules:g.a.CompletionItemInsertTextRule.InsertAsSnippet,range:e})}}catch(j){d.e(j)}finally{d.f()}return r}return[]}}]),e}(),v=n(359),f=n.n(v),x=n(48),O=function(e){Object(b.a)(n,e);var t=Object(j.a)(n);function n(e){var a,r,o;Object(u.a)(this,n),(o=t.call(this,e)).setFunctionName=function(e){o.setState({functionName:e})},o.setDatabase=function(e){o.setState({databaseName:e})},o.setBackend=function(e){o.setState({backend:e}),localStorage.setItem("backend",e)},o.post=Object(l.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.setState({result:void 0}),t=h.getURL("generate"),e.next=4,f.a.post(t,{sql:o.state.code,table:o.state.tableStructure,functionName:o.state.functionName});case 4:n=e.sent,o.setState({result:n.data});case 6:case"end":return e.stop()}}),e)}))),o.postDB=Object(l.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.setState({result:void 0}),t=h.getURL("generate_db"),"true"!==localStorage.getItem("createDB")){e.next=5;break}return e.next=5,o.createDB();case 5:return e.next=7,f.a.post(t,{sql:o.state.code,table:o.state.tableStructure,database:o.state.databaseName,functionName:o.state.functionName});case 7:n=e.sent,o.setState({result:n.data});case 9:case"end":return e.stop()}}),e)}))),o.createDB=Object(l.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("createScript"),n=h.getURL("create_db"),e.next=4,f.a.post(n,{data:t});case 4:case"end":return e.stop()}}),e)}))),o.setCode=function(e){o.setState({code:e}),window.localStorage.setItem("code",e)},o.setTable=function(e){o.setState({tableStructure:e}),window.localStorage.setItem("tableStructure",e)};var c=null!==(a=localStorage.getItem("backend"))&&void 0!==a?a:"python",s="true"===localStorage.getItem("createDB")?void 0:null!==(r=localStorage.getItem("dbName"))&&void 0!==r?r:void 0;return o.state={setCode:o.setCode,setBackend:o.setBackend,backend:c,setTable:o.setTable,post:o.post,setDatabase:o.setDatabase,postDB:o.postDB,setFunctionName:o.setFunctionName,databaseName:s},o}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=window.localStorage.getItem("code"),t=window.localStorage.getItem("tableStructure");this.setState({code:null!==e&&void 0!==e?e:"",tableStructure:null!==t&&void 0!==t?t:""})}},{key:"render",value:function(){return Object(x.jsx)(C.Provider,{value:this.state,children:this.props.children})}}]),n}(a.Component),y={},C=r.a.createContext(y),k=n(23),w=n(383),S=n(746),I=n(285),N=n(194),T=n(749),L=n(748),D=n(283),B=n(461),_=n(360),P=n.n(_),F=n(306),R=n(166),E=n(384),A=n(750),q=n(462),U=n(751),H=n(455),z=n(450),J=n.n(z);function K(){var e=r.a.useContext(C).result;return Object(x.jsx)("div",{style:{height:500,width:1e3},children:e&&Object(x.jsx)(J.a,{data:e.joinGraph,orientation:"vertical",pathFunc:"step",translate:{y:100,x:400},nodeSize:{x:257,y:175}})})}var M=n(454),G=n.n(M),Q=n(453),$=n.n(Q);function W(){var e=r.a.useContext(C).result;return Object(x.jsxs)(S.a,{children:[Object(x.jsx)($.a,{level:5,children:"Table with errors"}),Object(x.jsx)("ul",{children:null===e||void 0===e?void 0:e.errorTables.map((function(e){return Object(x.jsx)("li",{children:Object(x.jsx)(G.a,{children:e})},e)}))})]})}var Y=S.a.Title;S.a.Paragraph,S.a.Text,S.a.Link;function V(){var e=r.a.useContext(C).result,t=r.a.useState(!1),n=Object(k.a)(t,2),a=n[0],o=n[1],c=r.a.useState(!1),s=Object(k.a)(c,2);s[0],s[1];return r.a.useEffect((function(){o(!1)}),[e]),Object(x.jsxs)(T.a,{style:{width:"100%",height:"90vh",overflow:"scroll"},children:[Object(x.jsx)(A.a,{style:{position:"fixed",top:110,right:40},children:Object(x.jsxs)(I.a,{gutter:[10,10],children:[Object(x.jsx)(N.a,{children:Object(x.jsx)(D.a,{onClick:function(){var t;navigator.clipboard.writeText(null!==(t=null===e||void 0===e?void 0:e.code)&&void 0!==t?t:""),o(!0)},children:a?"Copied":"Copy"})}),Object(x.jsx)(N.a,{children:Object(x.jsx)(q.a,{content:Object(x.jsx)(K,{}),placement:"leftBottom",trigger:"click",children:Object(x.jsx)(D.a,{children:"Show Join Tree"})})})]})}),Object(x.jsx)(S.a,{children:Object(x.jsx)(Y,{children:"Result"})}),!1===(null===e||void 0===e?void 0:e.isFreeConnex)&&Object(x.jsx)(q.a,{content:Object(x.jsx)(W,{}),children:Object(x.jsx)(U.a,{type:"error",style:{marginBottom:10},message:"Cannot auto generate a free connex join tree from query. Check the join tree and reorder your join statement."})}),Object(x.jsx)(E.a,Object(R.a)(Object(R.a)({},E.b),{},{code:e.code,language:"cpp",theme:H.a,children:function(e){var t=e.className,n=e.style,a=e.tokens,r=e.getLineProps,o=e.getTokenProps;return Object(x.jsx)("pre",{className:t,style:n,children:a.map((function(e,t){return Object(x.jsx)("div",Object(R.a)(Object(R.a)({},r({line:e,key:t})),{},{children:e.map((function(e,t){return Object(x.jsx)("span",Object(R.a)({},o({token:e,key:t})))}))}))}))})}}))]})}var X=n(747),Z=n(745),ee=n(744),te=n(375),ne=n.n(te),ae=n(325),re=n.n(ae),oe=X.a.Option;function ce(){var e=r.a.useState(!1),t=Object(k.a)(e,2),n=t[0],a=t[1],o=r.a.useState(""),c=Object(k.a)(o,2),s=c[0],i=c[1],l=r.a.useState(!1),u=Object(k.a)(l,2),d=u[0],b=u[1],j=r.a.useState(""),m=Object(k.a)(j,2),g=m[0],p=m[1],h=Z.a.useForm(),v=(Object(k.a)(h,1)[0],r.a.useContext(C)),f=v.setBackend,O=v.backend,y=v.setDatabase,w=Object(x.jsxs)(X.a,{value:O,style:{width:200},onChange:function(e){return f(e)},children:[Object(x.jsx)(oe,{value:"python",children:"Use Default Backend"}),Object(x.jsx)(oe,{value:"db",children:"Use Query Plan"})]}),S="python"==O?[w]:[w,Object(x.jsx)(D.a,{type:"primary",onClick:function(){var e,t;i(null!==(e=localStorage.getItem("createScript"))&&void 0!==e?e:""),b("true"===localStorage.getItem("createDB")),p(null!==(t=localStorage.getItem("dbName"))&&void 0!==t?t:""),a(!0)},children:"Settings"})];return Object(x.jsxs)("div",{children:[Object(x.jsx)(ee.a,{title:"CodeGen",extra:S}),Object(x.jsxs)(re.a,{visible:n,title:"Database settings",onCancel:function(){return a(!1)},onOk:function(){localStorage.setItem("createScript",s),localStorage.setItem("createDB",!0===d?"true":"false"),localStorage.setItem("dbName",g),y(d?void 0:g),a(!1)},children:[d&&Object(x.jsx)("div",{style:{height:500},children:Object(x.jsx)(F.a,{value:s,options:{minimap:{enabled:!1}},onChange:function(e){return i(null!==e&&void 0!==e?e:"")},language:"sql"})}),Object(x.jsx)(ne.a,{checked:d,onChange:function(e){b(e.target.checked)},children:"Create database"}),!d&&Object(x.jsx)(L.a,{placeholder:"Database Name",value:g,onChange:function(e){return p(e.target.value)}})]})]})}var se={$schema:"http://json-schema.org/draft-06/schema#",type:"array",items:{$ref:"#/definitions/TableConfigElement"},definitions:{TableConfigElement:{type:"object",additionalProperties:!1,properties:{data_sizes:{type:"array",items:{type:"integer"}},table_name:{type:"string"},columns:{type:"array",items:{$ref:"#/definitions/Column"}}},required:["columns","data_sizes","table_name"],title:"TableConfigElement"},Column:{type:"object",additionalProperties:!1,properties:{column_type:{type:"string"},name:{type:"string"}},required:["column_type","name"],title:"Column"}}},ie=w.a.TabPane,le=S.a.Link;function ue(){var e=r.a.useState(window.innerHeight),t=Object(k.a)(e,2),n=t[0],a=t[1],o=r.a.useState(!1),c=Object(k.a)(o,2),s=c[0],u=c[1];r.a.useEffect((function(){window.addEventListener("resize",(function(){a(window.innerHeight)}))}),[]);var d=r.a.useContext(C),b=d.setCode,j=d.setTable,m=d.code,g=d.tableStructure,p=d.result,v=d.post,f=d.postDB,O=d.backend,y=d.functionName,R=d.setFunctionName,E=r.a.useCallback((function(e){e.languages.registerCompletionItemProvider("sql",{provideCompletionItems:function(e,t){var n=e.getWordUntilPosition(t),a={startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:n.startColumn,endColumn:n.endColumn};if(g)return{suggestions:h.generateSuggestions(a,g)}}}),e.languages.registerHoverProvider("sql",{provideHover:function(e,t){var n,a=e.getWordAtPosition(t),r={startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:null===a||void 0===a?void 0:a.startColumn,endColumn:null===a||void 0===a?void 0:a.endColumn};return h.generateHover(r,e,null!==(n=null===a||void 0===a?void 0:a.word)&&void 0!==n?n:"",g)}})}),[g]),A=r.a.useCallback((function(e){e.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,enableSchemaRequest:!0,schemas:[{uri:"https://raw.githubusercontent.com/sirily11/SECYAN-GEN/master/examples/table_config.json",fileMatch:["*"],schema:se}]})}),[g]);return Object(x.jsxs)(P.a,{style:{height:"100vh",overflow:"hidden",padding:10},children:[Object(x.jsx)(ce,{}),Object(x.jsx)(P.a,{children:Object(x.jsx)(_.Content,{style:{height:"100%"},children:Object(x.jsxs)(I.a,{style:{height:"80%"},gutter:[16,10],children:[Object(x.jsx)(N.a,{span:8,children:Object(x.jsxs)(T.a,{children:[Object(x.jsxs)(w.a,{defaultActiveKey:"0",onChange:function(){},children:[Object(x.jsx)(ie,{tab:"Function Info",children:Object(x.jsx)(L.a,{value:y,placeholder:"Function Name",onChange:function(e){R(e.target.value)}})},"0"),Object(x.jsx)(ie,{tab:"SQL Statement",children:Object(x.jsx)(F.a,{height:n-300,beforeMount:function(e){E(e)},language:"sql",value:m,options:{minimap:{enabled:!1}},onChange:function(e){e&&b(e)}})},"1"),Object(x.jsxs)(ie,{tab:"Table structure",children:[Object(x.jsx)(S.a,{children:Object(x.jsx)(le,{target:"_blank",href:"https://github.com/sirily11/SECYAN-GEN/blob/master/examples/table_config.json",children:"Example Table Structure"})}),Object(x.jsx)(F.a,{height:n-300,value:g,beforeMount:function(e){return A(e)},language:"json",options:{minimap:{enabled:!1}},onChange:function(e){e&&j(e)}})]},"2")]}),Object(x.jsx)(I.a,{style:{justifyContent:"flex-end",marginTop:10},children:Object(x.jsx)(D.a,{type:"primary",loading:s,onClick:Object(l.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u(!0),0!==(null===m||void 0===m?void 0:m.length)&&0!==(null===g||void 0===g?void 0:g.length)){e.next=5;break}return window.alert("Invaild Input"),u(!1),e.abrupt("return");case 5:if(e.prev=5,"python"!=O){e.next=11;break}return e.next=9,v();case 9:e.next=13;break;case 11:return e.next=13,f();case 13:B.a.success({message:"Code generated"}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),B.a.error({message:"Cannot generate code",description:"".concat(null!==(t=null===e.t0||void 0===e.t0||null===(n=e.t0.response)||void 0===n?void 0:n.data)&&void 0!==t?t:"Cannot connect to the backend"),duration:5});case 19:return e.prev=19,u(!1),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[5,16,19,22]])}))),children:"Convert"})})]})}),Object(x.jsx)(N.a,{span:16,children:p&&Object(x.jsx)(V,{})})]})})})]})}var de=function(){return Object(x.jsx)(O,{children:Object(x.jsx)(ue,{})})},be=function(e){e&&e instanceof Function&&n.e(75).then(n.bind(null,823)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),o(e),c(e)}))};c.a.render(Object(x.jsx)(r.a.StrictMode,{children:Object(x.jsx)(de,{})}),document.getElementById("root")),be()}},[[739,3,4]]]);
//# sourceMappingURL=main.222f13a3.chunk.js.map