(this.webpackJsonpwebapp=this.webpackJsonpwebapp||[]).push([[2],{478:function(e,t,n){},858:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),i=n(66),o=n.n(i),r=(n(478),n(16)),s=n(387),l=n(133),u=n(909),d=n(917),b=n(337),j=n(927),h=n(928),f=(n(588),n(460)),m=n(924),p=n(925),g=n(926),x=n(12),O=n.n(x),v=n(193),C=n(552),y=n(555),w=n(308),k=n.n(w),S="/schema",R="/download_data",I="/generate_python",_="code",T="role",N="datadir",D="backend",E="tableStructure",L=n(7),A=n(1),J=n(2),z=[{keyword:"select",desc:""},{keyword:"from",desc:""},{keyword:"where",desc:""},{keyword:"sum",desc:"Aggregation function"},{keyword:"max",desc:"Aggregation function"},{keyword:"avg",desc:"Aggregation function"},{keyword:"count",desc:"Aggregation function"},{keyword:"group by",desc:""},{keyword:"desc",desc:""},{keyword:"limit",desc:""},{keyword:"having",desc:""},{keyword:"exists",desc:""}],P=function(){function e(){Object(A.a)(this,e)}return Object(J.a)(e,null,[{key:"getURL",value:function(e){return new URL(e,"https://cwvf54ckb6.execute-api.ap-east-1.amazonaws.com/dev/").href}},{key:"generateHover",value:function(e,t,n,a){if(!a)return{range:e,contents:[]};var c,i=Object(L.a)(z);try{for(i.s();!(c=i.n()).done;){var o=c.value;if(n.toLowerCase().includes(o.keyword.toLowerCase()))return{range:e,contents:[{value:"SQL Built In"},{value:o.desc}]}}}catch(j){i.e(j)}finally{i.f()}var r,s=Object(L.a)(a);try{for(s.s();!(r=s.n()).done;){var l=r.value;if(n.toLowerCase().includes(l.table_name.toLowerCase()))return{range:e,contents:[{value:"Table Name"}]};var u,d=Object(L.a)(l.columns);try{for(d.s();!(u=d.n()).done;){var b=u.value;if(n.toLocaleLowerCase().includes(b.name.toLowerCase()))return{range:e,contents:[{value:l.table_name},{value:"**Type: ".concat(b.column_type,"**")}]}}}catch(j){d.e(j)}finally{d.f()}}}catch(j){s.e(j)}finally{s.f()}}}]),e}(),q=n(28),B=c.a.createContext({});function K(e){var t=e.children,n=c.a.useState([]),a=Object(r.a)(n,2),i=a[0],o=a[1],s=c.a.useState(!1),l=Object(r.a)(s,2),u=l[0],d=l[1];c.a.useEffect((function(){var e=localStorage.getItem(E);null!==e&&o(JSON.parse(e))}),[]),c.a.useEffect((function(){localStorage.setItem(E,JSON.stringify(i))}),[i]);var b=c.a.useCallback((function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];localStorage.setItem(E,JSON.stringify(e)),t&&o(JSON.parse(JSON.stringify(e)))}),[i]),j=c.a.useCallback(Object(v.a)(O.a.mark((function e(){var t,n,a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=P.getURL(S),e.next=4,k.a.get(t);case 4:n=e.sent,b(n.data),C.b.success("Tables are updated"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),y.a.error({message:"Cannot fetch table configs",description:"".concat(null!==(a=null===e.t0||void 0===e.t0||null===(c=e.t0.response)||void 0===c?void 0:c.data)&&void 0!==a?a:"Cannot connect to the backend"),duration:5,placement:"bottomRight"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),[]),h={configs:i,setConfigs:b,setOpenRawConfigDialog:d,openRawConfigDialog:u,fetchConfigs:j};return Object(q.jsx)(B.Provider,{value:h,children:t})}var M=n(423),Y=n(911),F=n(220),U=n(913),V=n(914),G={$schema:"http://json-schema.org/draft-06/schema#",type:"array",items:{$ref:"#/definitions/TableConfigElement"},definitions:{TableConfigElement:{type:"object",additionalProperties:!1,properties:{data_sizes:{type:"array",items:{type:"integer"}},data_paths:{type:"array",items:{type:"string"}},annotations:{type:"array",items:{type:"string"}},table_name:{type:"string"},owner:{type:"string"},columns:{type:"array",items:{$ref:"#/definitions/Column"}}},required:["columns","data_sizes","table_name","data_paths","annotations"],title:"TableConfigElement"},Column:{type:"object",additionalProperties:!1,properties:{column_type:{type:"string"},name:{type:"string"}},required:["column_type","name"],title:"Column"}}};function H(){var e=c.a.useContext(B),t=e.setOpenRawConfigDialog,n=e.openRawConfigDialog,a=e.configs,i=e.setConfigs,o=c.a.useState(""),s=Object(r.a)(o,2),l=s[0],u=s[1],d=c.a.useCallback((function(){u(JSON.stringify(a,null,4)),t(!0)}),[a]),b=c.a.useCallback((function(){i(JSON.parse(l)),t(!1)}),[l]),j=c.a.useCallback((function(e){e.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,enableSchemaRequest:!0,schemas:[{uri:"https://raw.githubusercontent.com/sirily11/SECYAN-GEN/master/examples/table_config.json",fileMatch:["*"],schema:G}]})}),[l]);return Object(q.jsxs)(Y.a,{title:"Table Configuration",subTitle:"Config your table's info here",extra:[Object(q.jsx)(F.a,{type:"primary",onClick:d,children:"Set Raw Data"})],children:[Object(q.jsxs)(U.a,{style:{maxWidth:"800px"},children:["You can either use the raw Data Config Editor to modify your database table's infomation, or use the GUI below to modify your table. You can check this"," ",Object(q.jsx)(U.a.Link,{target:"_blank",href:"https://github.com/sirily11/SECYAN-GEN/blob/master/examples/table_config.json",children:"Link"})," ","for example table configuration. You can also fetch table schema by clicking the fetching button. The data path and size field might be empty and will be updated when you click fetch data in settings page. You can update the field mannuly by using raw data editor, however, we don't recommand editting this field mannully."]}),Object(q.jsx)(V.a,{title:"Raw Data Configuration",visible:n,onOk:b,onCancel:b,footer:[Object(q.jsx)(F.a,{onClick:b,children:"Close"})],width:.8*window.innerWidth,children:Object(q.jsx)(M.a,{height:500,language:"json",options:{minimap:{enabled:!1}},beforeMount:function(e){return j(e)},value:l,onChange:function(e){u(null!==e&&void 0!==e?e:"")}})})]})}var W=n(462),$=n(171),Q=n(916),X=n(910),Z=n(224),ee=n(365),te=n(915),ne=n(918),ae=n(557),ce=n(919),ie=n(558),oe=["int","string","decimal","date"],re=["CLIENT","SERVER"],se={testCardPathId:"table-config-path",testCardSizeId:"table-config-size"},le=n(497);function ue(e){var t,n=e.config,a=e.index,i=c.a.useState(n.table_name),o=Object(r.a)(i,2),s=o[0],l=o[1],u=c.a.useState(n.owner),j=Object(r.a)(u,2),h=j[0],f=j[1],m=c.a.useState(!1),p=Object(r.a)(m,2),g=p[0],x=p[1],O=c.a.useContext(B),v=O.setConfigs,C=O.configs,w=c.a.useCallback((function(){return Object($.a)(Object($.a)({},n),{},{annotations:n.annotations.map((function(e){return{annotation:e}}))})}),[n]),k=c.a.useCallback((function(){C[a].table_name=s,C[a].owner=h,v(C),x(!1)}),[s,h]),S=c.a.useCallback((function(e){console.log(e.annotations);var t=e.annotations.filter((function(e){return void 0!==e&&void 0!==e.annotation})).map((function(e){return e.annotation}));C[a].columns=e.columns,C[a].annotations=void 0!==t?t:[],v(C,!1)}),[n,C]),R=c.a.useCallback((function(){V.a.confirm({title:"confirm",content:"Delete this table",onOk:function(){C.splice(a,1),v(JSON.parse(JSON.stringify(C))),y.a.success({message:"Table deleted",placement:"bottomRight"})}})}),[n]);return Object(q.jsxs)(d.a,{id:n.table_name,title:"".concat(n.table_name," - ").concat(null!==(t=n.owner)&&void 0!==t?t:"Client"),style:{margin:10},extra:[Object(q.jsx)(F.a,{shape:"circle",onClick:R,style:{marginRight:10},children:Object(q.jsx)(ne.a,{})}),Object(q.jsx)(F.a,{shape:"circle",onClick:function(){return x(!0)},children:Object(q.jsx)(ae.a,{})})],children:[Object(q.jsxs)(Q.b,{title:"Data size and path",bordered:!0,children:[Object(q.jsx)(Q.b.Item,{label:"Data Path",children:Object(q.jsx)("div",{"data-testid":se.testCardPathId,children:n.data_paths})}),Object(q.jsx)(Q.b.Item,{label:"Data Size",children:Object(q.jsx)("div",{"data-testid":se.testCardSizeId,children:n.data_sizes})})]}),Object(q.jsxs)(X.a,{style:{marginTop:20},initialValues:w(),onValuesChange:function(e,t){S(t)},children:[Object(q.jsx)(U.a.Title,{level:5,children:"Table Columns"}),Object(q.jsx)(X.a.List,{name:"columns",children:function(e,t){var n=t.add,a=t.remove;return Object(q.jsxs)(b.a,{gutter:[10,10],children:[e.map((function(e){var t=e.key,n=e.name,c=e.fieldKey,i=Object(W.a)(e,["key","name","fieldKey"]);return Object(q.jsx)(Z.a,{style:{display:"flex",marginBottom:8},xs:24,children:Object(q.jsxs)(b.a,{style:{width:"100%"},gutter:[20,10],children:[Object(q.jsx)(Z.a,{md:5,xs:24,children:Object(q.jsx)(X.a.Item,Object($.a)(Object($.a)({},i),{},{name:[n,"column_type"],fieldKey:[c,"type"],rules:[{required:!0,message:"Column type is required"}],children:Object(q.jsx)(ee.a,{children:oe.map((function(e,t){return Object(q.jsx)(ee.a.Option,{value:e,children:e})}))})}))}),Object(q.jsx)(Z.a,{md:5,xs:22,children:Object(q.jsx)(X.a.Item,Object($.a)(Object($.a)({},i),{},{name:[n,"name"],fieldKey:[c,"name"],rules:[{required:!0,message:"Column name is required"}],children:Object(q.jsx)(te.a,{placeholder:"Column Name"})}))}),Object(q.jsx)(Z.a,{span:2,children:Object(q.jsx)(ce.a,{onClick:function(){return a(n)}})})]})},"column-".concat(t))})),Object(q.jsx)(Z.a,{xs:24,children:Object(q.jsx)(X.a.Item,{children:Object(q.jsx)(F.a,{type:"dashed",onClick:function(){return n()},block:!0,icon:Object(q.jsx)(ie.a,{}),children:"Add Column"})})},"button-".concat(Object(le.a)()))]})}}),Object(q.jsx)(U.a.Title,{level:5,children:"Annotations"}),Object(q.jsx)(X.a.List,{name:"annotations",children:function(e,t){var n=t.add,a=t.remove;return Object(q.jsxs)("div",{children:[e.map((function(e){e.key;var t=e.name,n=e.fieldKey;Object(W.a)(e,["key","name","fieldKey"]);return Object(q.jsxs)(b.a,{gutter:[10,10],children:[Object(q.jsx)(Z.a,{span:22,children:Object(q.jsx)(X.a.Item,{name:[t,"annotation"],fieldKey:[n,"annotation"],label:"Annotation",children:Object(q.jsx)(te.a,{})})}),Object(q.jsx)(Z.a,{children:Object(q.jsx)(ce.a,{onClick:function(){return a(t)}})})]})})),Object(q.jsx)(X.a.Item,{children:Object(q.jsx)(F.a,{type:"dashed",onClick:function(){return n()},block:!0,icon:Object(q.jsx)(ie.a,{}),children:"Add Annotation"})})]})}})]}),Object(q.jsxs)(V.a,{visible:g,title:"Table name",onCancel:function(){l(n.table_name),f(n.owner),x(!1)},onOk:k,children:[Object(q.jsx)(te.a,{placeholder:"Table name",value:s,onChange:function(e){l(e.target.value)}}),Object(q.jsx)(ee.a,{style:{width:"100%",marginTop:20},placeholder:"Select Owner",value:h,onChange:function(e){return f(e)},children:re.map((function(e){return Object(q.jsx)(ee.a.Option,{value:e,children:e},e)}))})]})]},a)}var de=n(406),be=n.n(de);function je(){var e=c.a.useContext(B),t=e.configs,n=(e.setConfigs,c.a.useState(!1)),a=Object(r.a)(n,2),i=(a[0],a[1],c.a.useState(!0)),o=Object(r.a)(i,2),s=o[0],u=o[1],d=Object(l.g)(),b=be.a.parse(d.search);return c.a.useEffect((function(){setTimeout((function(){u(!1)}),50)}),[]),c.a.useEffect((function(){var e=b.table;if(e){var t=document.getElementById(e);null===t||void 0===t||t.scrollIntoView()}}),[d.search,s]),Object(q.jsxs)("div",{style:{overflowY:"scroll",height:"100%"},children:[Object(q.jsx)(H,{}),!s&&t.map((function(e,t){return Object(q.jsx)(ue,{config:e,index:t},"config-".concat(t))}))]})}var he=n(459),fe=c.a.createContext({});function me(e){var t=e.children,n=c.a.useState([]),a=Object(r.a)(n,2),i=a[0],o=a[1],s=c.a.useState(!1),l=Object(r.a)(s,2),u=l[0],d=l[1],b=c.a.useState(0),j=Object(r.a)(b,2),h=j[0],f=j[1],m=c.a.useState(!1),p=Object(r.a)(m,2),g=p[0],x=p[1];c.a.useEffect((function(){var e=localStorage.getItem(_);if(e)try{o(JSON.parse(e))}catch(t){console.log("No Code Saved")}}),[]);var C=c.a.useCallback((function(e){localStorage.setItem(_,JSON.stringify(e)),o(JSON.parse(JSON.stringify(e)))}),[i]),w=c.a.useCallback(function(){var e=Object(v.a)(O.a.mark((function e(t,n){var a,c,o,r,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=P.getURL(I),c=i[t],e.prev=2,d(!0),e.next=6,k.a.post(a,{sql:c.code,annotation_name:c.annotation_name,num_of_rows:c.num_of_rows,table:JSON.stringify(n)});case 6:o=e.sent,i[t].result=o.data,C(i),y.a.info({message:"Code results returned",placement:"bottomRight"}),d(!1),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),d(!1),y.a.error({message:"Cannot generate code",description:"".concat(null!==(r=null===e.t0||void 0===e.t0||null===(s=e.t0.response)||void 0===s?void 0:s.data)&&void 0!==r?r:"Cannot connect to the backend"),duration:5,placement:"bottomRight"});case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t,n){return e.apply(this,arguments)}}(),[i]),S=c.a.useCallback((function(){i.forEach((function(e){e.result=void 0})),C(i)}),[i]),R={codeRunResults:i,setCodeRunResults:C,runCode:w,isLoading:u,index:h,setIndex:f,showEdit:g,setShowEdit:x,deleteResultCache:S};return Object(q.jsx)(fe.Provider,{value:R,children:t})}var pe=c.a.createContext({});function ge(e){var t=c.a.useState(!1),n=Object(r.a)(t,2),a=n[0],i=n[1],o=c.a.useState("Server"),s=Object(r.a)(o,2),l=s[0],u=s[1],d=c.a.useState("Default Backend"),b=Object(r.a)(d,2),j=b[0],h=b[1],f=c.a.useState(""),m=Object(r.a)(f,2),p=m[0],g=m[1],x=c.a.useState(!1),w=Object(r.a)(x,2),S=w[0],I=w[1];c.a.useEffect((function(){var e=localStorage.getItem(T),t=localStorage.getItem(D),n=localStorage.getItem(N);e&&u(e),t&&h(t),n&&g(n),i(!0)}),[]);var _=c.a.useCallback((function(e){localStorage.setItem(N,e),g(e)}),[]),E=c.a.useCallback((function(e){localStorage.setItem(T,e),u(e)}),[]),L=c.a.useCallback((function(e){localStorage.setItem(D,e),h(e)}),[]),A=c.a.useCallback(function(){var e=Object(v.a)(O.a.mark((function e(t){var n,a,c,i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I(!0),e.prev=1,n=P.getURL(R),e.next=5,k.a.post(n,{tables:JSON.stringify(t),output_dir:p});case 5:return a=e.sent,C.b.success("Successfully dump data into "+p,8),e.abrupt("return",a.data);case 10:return e.prev=10,e.t0=e.catch(1),y.a.error({message:"Cannot fetch table configs",description:"".concat(null!==(c=null===e.t0||void 0===e.t0||null===(i=e.t0.response)||void 0===i?void 0:i.data)&&void 0!==c?c:"Cannot connect to the backend"),duration:5,placement:"bottomRight"}),e.abrupt("return",void 0);case 14:return e.prev=14,I(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,10,14,17]])})));return function(t){return e.apply(this,arguments)}}(),[p]),J={role:l,setRole:E,backend:j,setBackend:L,datadir:p,setDatadir:_,loaded:a,isDownloading:S,downloadData:A};return Object(q.jsx)(pe.Provider,{value:J,children:e.children})}var xe=n(543),Oe=n(294),ve=function(){function e(){Object(A.a)(this,e)}return Object(J.a)(e,null,[{key:"generateSuggestions",value:function(e,t){if(t){var n,a=[],c=Object(L.a)(t);try{for(c.s();!(n=c.n()).done;){var i=n.value;a.push({label:i.table_name,kind:Oe.a.CompletionItemKind.Constant,documentation:"",insertText:i.table_name.toUpperCase(),insertTextRules:Oe.a.CompletionItemInsertTextRule.InsertAsSnippet,range:e});var o,r=Object(L.a)(i.columns);try{for(r.s();!(o=r.n()).done;){var s=o.value;a.push({label:s.name,kind:Oe.a.CompletionItemKind.Constant,documentation:"".concat(s.column_type),insertText:s.name,insertTextRules:Oe.a.CompletionItemInsertTextRule.InsertAsSnippet,range:e})}}catch(b){r.e(b)}finally{r.f()}}}catch(b){c.e(b)}finally{c.f()}var l,u=Object(L.a)(z);try{for(u.s();!(l=u.n()).done;){var d=l.value;a.push({label:d.keyword,kind:Oe.a.CompletionItemKind.Keyword,document:d.desc,insertText:d.keyword.toUpperCase(),insertTextRules:Oe.a.CompletionItemInsertTextRule.InsertAsSnippet,range:e})}}catch(b){u.e(b)}finally{u.f()}return a}return[]}}]),e}(),Ce=void 0,ye=void 0;function we(e){var t=e.codeRunResult,n=e.index,a=c.a.useContext(fe),i=a.setCodeRunResults,o=a.codeRunResults,s=(a.showEdit,a.setShowEdit,c.a.useState(!0)),l=Object(r.a)(s,2),u=l[0],d=l[1],j=c.a.useContext(B).configs,h=c.a.useContext(pe).role,f=c.a.useState(),m=Object(r.a)(f,2),p=m[0],g=m[1],x=c.a.useCallback((function(e){var t,n;null===(t=Ce)||void 0===t||t.dispose(),null===(n=ye)||void 0===n||n.dispose(),ye=e.languages.registerCompletionItemProvider("sql",{provideCompletionItems:function(e,t){var n=e.getWordUntilPosition(t),a={startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:n.startColumn,endColumn:n.endColumn};if(j)return{suggestions:ve.generateSuggestions(a,j)}}}),Ce=e.languages.registerHoverProvider("sql",{provideHover:function(e,t){var n,a=e.getWordAtPosition(t),c={startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:null===a||void 0===a?void 0:a.startColumn,endColumn:null===a||void 0===a?void 0:a.endColumn};return P.generateHover(c,e,null!==(n=null===a||void 0===a?void 0:a.word)&&void 0!==n?n:"",j)}})}),[j,p]);c.a.useEffect((function(){y.a.info({message:"Loading Data",placement:"bottomRight"})}),[]);var O=c.a.useCallback((function(e){o[n].code=e,i(o)}),[t]);return Object(q.jsx)("div",{style:{padding:10},children:Object(q.jsxs)(b.a,{gutter:[10,10],children:[Object(q.jsx)(Z.a,{xs:8,children:Object(q.jsx)(M.a,{value:t.code,onMount:function(e){g(e),d(!1),y.a.close("Data Loaded")},language:"sql",beforeMount:function(e){return x(e)},options:{minimap:{enabled:!1}},height:"calc(100vh - 64px - 56px - 20px)",onChange:function(e){O(e)}})}),Object(q.jsx)(Z.a,{xs:16,style:{overflowY:"scroll",overflowX:"scroll",height:"100%"},children:Object(q.jsx)("div",{style:{height:"calc(100vh - 64px - 56px - 30px)",overflowY:"hidden"},children:t.result&&!u&&Object(q.jsx)(xe.a,{columns:function(){var e,n,a,c="Server"===h?null===(e=t.result)||void 0===e?void 0:e.server_result:null===(n=t.result)||void 0===n?void 0:n.client_result;return null!==(a=null===c||void 0===c?void 0:c.length)&&void 0!==a&&a?c[0].map((function(e){return{title:e.toLocaleUpperCase(),field:e.toLowerCase(),width:20*e.length}})):[]}(),rows:function(){var e,n,a=[],c="Server"===h?null===(e=t.result)||void 0===e?void 0:e.server_result:null===(n=t.result)||void 0===n?void 0:n.client_result;if(c){var i=c[0];c.slice(1).forEach((function(e,t){var n={id:t};e.forEach((function(e,t){n[i[t]]=e})),a.push(n)}))}return a}(),rowHeight:60})})})]})})}function ke(){var e=c.a.useContext(fe),t=e.codeRunResults,n=e.setCodeRunResults,a=e.setIndex,i=(c.a.useContext(B).configs,c.a.useCallback((function(){return t.map((function(e,t){return Object(q.jsx)(he.a.TabPane,{tab:e.name,style:{height:"100%"},children:Object(q.jsx)(we,{codeRunResult:e,index:t})},t)}))}),[t]));return Object(q.jsx)(he.a,{type:"editable-card",style:{height:"100%"},addIcon:Object(q.jsx)(ie.a,{}),onChange:function(e){a(parseInt(e))},onEdit:function(e,a){"add"===a?(t.push({name:"newResult",code:"",num_of_rows:100,annotation_name:"q3_annot"}),n(t)):(t.splice(parseInt(e),1),n(t))},children:i()})}var Se=n(235),Re=n(556),Ie=n(920),_e=n(921),Te=n(922),Ne=n(386),De=n.n(Ne),Ee=n(545),Le=n.n(Ee);function Ae(){var e,t=c.a.useContext(fe),n=null===(e=t.codeRunResults[t.index])||void 0===e?void 0:e.result;return Object(q.jsx)("div",{style:{height:500,width:1e3},children:n&&Object(q.jsx)(Le.a,{data:n.joinGraph,orientation:"vertical",pathFunc:"step",translate:{y:100,x:400},nodeSize:{x:257,y:175}})})}function Je(){var e,t=c.a.useContext(fe),n=t.setCodeRunResults,a=t.codeRunResults,i=t.runCode,o=t.isLoading,s=t.index,l=t.setShowEdit,u=t.showEdit,d=c.a.useContext(B).configs,j=c.a.useContext(pe),h=j.role,f=j.setRole,m=X.a.useForm(),p=Object(r.a)(m,1)[0],g=c.a.useCallback((function(){var e=p.getFieldsValue();a[s].annotation_name=e.annotation_name,a[s].name=e.name,a[s].num_of_rows=parseInt(e.num_of_rows),n(a),l(!1)}),[a,s]);return c.a.useEffect((function(){p.setFieldsValue(a[s])}),[u]),Object(q.jsxs)(b.a,{justify:"end",style:{marginRight:20},children:[Object(q.jsx)(Se.a,{title:"Run Code",children:Object(q.jsx)(F.a,{shape:"round",size:"large",style:{marginRight:10},loading:o,onClick:Object(v.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(s,d);case 2:case"end":return e.stop()}}),e)}))),children:Object(q.jsx)(Ie.a,{})})}),Object(q.jsx)(Se.a,{title:'"Current role: '.concat(h,'"'),children:Object(q.jsx)(F.a,{shape:"round",size:"large",style:{marginRight:10},onClick:Object(v.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f("Client"===h?"Server":"Client");case 1:case"end":return e.stop()}}),e)}))),children:Object(q.jsx)(_e.a,{})})}),Object(q.jsx)(Se.a,{title:"Rename",children:Object(q.jsx)(F.a,{shape:"round",size:"large",style:{marginRight:10},onClick:function(){l(!0)},children:Object(q.jsx)(ae.a,{})})}),(null===(e=a[s])||void 0===e?void 0:e.result)&&Object(q.jsx)(Re.a,{content:Object(q.jsx)(Ae,{}),placement:"leftBottom",trigger:"click",children:Object(q.jsx)(Se.a,{title:"Join Tree",children:Object(q.jsx)(F.a,{shape:"round",size:"large",style:{marginRight:10},onClick:function(){},children:Object(q.jsx)(Te.a,{})})})}),Object(q.jsx)(De.a,{title:"Configuration",visible:u,onOk:g,onCancel:function(){p.resetFields(),l(!1)},children:Object(q.jsxs)(X.a,{initialValues:a[s],form:p,children:[Object(q.jsx)(X.a.Item,{name:"name",label:"Name",children:Object(q.jsx)(te.a,{placeholder:"Name"})}),Object(q.jsx)(X.a.Item,{name:"num_of_rows",label:"Number of rows",children:Object(q.jsx)(te.a,{placeholder:"Num of rows",type:"number"})}),Object(q.jsx)(X.a.Item,{name:"annotation_name",label:"Annotation Name",children:Object(q.jsx)(te.a,{placeholder:"Annotation Name"})})]})})]})}var ze=n(912),Pe=n(546);function qe(){var e=c.a.useContext(pe),t=e.role,n=e.setRole,a=e.backend,i=e.setBackend,o=e.datadir,r=e.setDatadir,s=e.loaded,l=e.downloadData,u=e.isDownloading,b=c.a.useContext(B),j=b.configs,h=b.setConfigs,f=c.a.useContext(fe).deleteResultCache,m={role:t,backend:a,datadir:o},p=Object(q.jsxs)("div",{children:[Object(q.jsxs)(d.a,{children:[Object(q.jsx)(U.a.Title,{level:5,children:"General Settings"}),Object(q.jsxs)(X.a,{initialValues:m,onValuesChange:function(e){e.role&&n(e.role),e.backend&&i(e.backend),e.datadir&&r(e.datadir)},children:[Object(q.jsx)(X.a.Item,{label:"Default data dir",name:"datadir",help:"Your table's data will be stored in this folder",children:Object(q.jsx)(te.a,{})}),Object(q.jsx)(X.a.Item,{label:"Role",name:"role",children:Object(q.jsx)(ee.a,{children:["Client","Server"].map((function(e,t){return Object(q.jsx)(ee.a.Option,{value:e,children:e},"role-".concat(t))}))})}),Object(q.jsx)(X.a.Item,{label:"Backend",name:"backend",extra:"This will only affect the c++ code generator",children:Object(q.jsx)(ee.a,{children:["Default Backend","Postgres Backend"].map((function(e,t){return Object(q.jsx)(ee.a.Option,{value:e,children:e},"role-".concat(t))}))})})]})]}),Object(q.jsx)(d.a,{title:"Data",style:{marginTop:10},children:Object(q.jsxs)(ze.b,{children:[Object(q.jsxs)(ze.b.Item,{children:[Object(q.jsx)(ze.b.Item.Meta,{title:"Stored results",description:"Your query results"}),Object(q.jsx)(F.a,{onClick:function(){f(),C.b.success("Delete cache successfully")},children:"Delete"})]}),Object(q.jsxs)(ze.b.Item,{children:[Object(q.jsx)(ze.b.Item.Meta,{title:"Download Data",description:"Download table data from database"}),Object(q.jsx)(F.a,{loading:u,onClick:Object(v.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(j);case 2:(t=e.sent)&&h(t);case 4:case"end":return e.stop()}}),e)}))),children:"Download data"})]})]})})]});return Object(q.jsxs)("div",{style:{padding:10},children:[Object(q.jsx)(U.a.Title,{level:3,children:"Settings"}),s?p:Object(q.jsx)(Pe.a,{})]})}var Be=n(923);function Ke(){var e=c.a.useState(!1),t=Object(r.a)(e,2),n=t[0],a=t[1],i=c.a.useState(!1),o=Object(r.a)(i,2),s=o[0],l=o[1],u=c.a.useContext(B),d=u.configs,b=u.setConfigs,j=u.fetchConfigs,h=c.a.useCallback((function(){d.push({table_name:"table",data_sizes:[],data_paths:[],columns:[],owner:"Server",annotations:[]}),b(d),a(!1),y.a.success({message:"Added a new table",placement:"bottomRight"})}),[d]);return Object(q.jsxs)("div",{children:[Object(q.jsx)(Se.a,{title:"Fetch Table Config from DB",children:Object(q.jsx)(F.a,{shape:"round",loading:s,style:{marginRight:20},onClick:Object(v.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.next=3,j();case 3:l(!1);case 4:case"end":return e.stop()}}),e)}))),children:Object(q.jsx)(Be.a,{})})}),Object(q.jsx)(Se.a,{title:"Create a new table",children:Object(q.jsx)(F.a,{shape:"round",style:{marginRight:20},onClick:function(){return a(!0)},children:Object(q.jsx)(ie.a,{})})}),Object(q.jsx)(V.a,{visible:n,title:"Add New Table",onOk:h,onCancel:function(){a(!1)},children:Object(q.jsx)(U.a,{children:"Create a empty table?"})})]})}var Me=[{path:"/",title:"Table Config",component:Object(q.jsx)(je,{}),icon:Object(q.jsx)(m.a,{}),action:Object(q.jsx)(Ke,{}),hasSubMenu:!0},{path:"/settings",title:"Settings",component:Object(q.jsx)(qe,{}),icon:Object(q.jsx)(p.a,{}),hasSubMenu:!1},{path:"/editor",title:"Query Editor",component:Object(q.jsx)(ke,{}),icon:Object(q.jsx)(g.a,{}),hasSubMenu:!1,action:Object(q.jsx)(Je,{})}],Ye=n(548),Fe=n.n(Ye);function Ue(e){var t=c.a.useContext(B).configs,n=Object(l.g)(),a=Object(l.f)(),i=c.a.useState(Me[0].title),o=Object(r.a)(i,2),s=o[0],u=o[1],d=(e.expanded,be.a.parse(n.search).table);c.a.useEffect((function(){if(n.pathname!==Me[0].path){var e=Me.find((function(e){return n.pathname.includes(e.path)&&e.path!==Me[0].path}));e&&u(null===e||void 0===e?void 0:e.title)}else u(Me[0].title)}),[n]);var b=c.a.useCallback((function(e){return e===Me[0].path?t.map((function(e,t){return Object(q.jsx)(f.a.Item,{onClick:function(){a.push("".concat(Me[0].path,"?table=").concat(e.table_name))},children:e.table_name},e.table_name)})):[]}),[t]),j=c.a.useCallback((function(){return Me.map((function(e){var t=b(e.path);return e.hasSubMenu?Object(q.jsx)(Fe.a,{title:e.title,onTitleClick:function(){return a.push(e.path)},icon:e.icon,children:t},e.title):Object(q.jsx)(f.a.Item,{icon:e.icon,onClick:function(){return a.push(e.path)},children:e.title},e.title)}))}),[t]);return Object(q.jsx)(f.a,{theme:"light",mode:"inline",selectedKeys:void 0===d?[s]:[d],style:{height:"100%"},children:j()})}u.a.Header;var Ve=u.a.Sider,Ge=u.a.Content;var He=function(){var e=c.a.useState(!1),t=Object(r.a)(e,2),n=t[0],a=t[1];return Object(q.jsx)("div",{style:{overflow:"hidden"},children:Object(q.jsx)(ge,{children:Object(q.jsx)(me,{children:Object(q.jsx)(K,{children:Object(q.jsx)(s.a,{children:Object(q.jsxs)(u.a,{style:{height:"100vh",overflow:"hidden"},children:[Object(q.jsx)(d.a,{style:{margin:0,padding:0},bodyStyle:{padding:0},children:Object(q.jsxs)(b.a,{align:"middle",children:[Object(q.jsx)("div",{className:"trigger",onClick:function(){return a(!n)},children:n?Object(q.jsx)(j.a,{}):Object(q.jsx)(h.a,{})}),Object(q.jsx)("h1",{style:{padding:10},children:"CodeGen"}),Object(q.jsx)("div",{style:{flexGrow:1},children:" "}),Object(q.jsx)(l.c,{children:Me.map((function(e,t){return Object(q.jsx)(l.a,{path:e.path,exact:!0,children:e.action},"route-action-".concat(t))}))})]})}),Object(q.jsxs)(u.a,{style:{background:"white"},children:[Object(q.jsx)(Ve,{collapsible:!0,style:{background:"#fff"},trigger:null,collapsed:n,children:Object(q.jsx)(Ue,{expanded:!n})}),Object(q.jsx)(Ge,{style:{margin:"0px 0px",padding:0,minHeight:280},children:Object(q.jsx)(l.c,{children:Me.map((function(e,t){return Object(q.jsx)(l.a,{path:e.path,exact:!0,children:e.component},"route-".concat(t))}))})})]})]})})})})})})},We=function(e){e&&e instanceof Function&&n.e(75).then(n.bind(null,1001)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),i(e),o(e)}))};o.a.render(Object(q.jsx)(c.a.StrictMode,{children:Object(q.jsx)(He,{})}),document.getElementById("root")),We()}},[[858,3,4]]]);
//# sourceMappingURL=main.d585935b.chunk.js.map